{% extends "base.html" %}

{% load static %}
{% load imagekit %}

{% block android_header %}
    {% with mdl_navigation__link__current='record-list' %}
        {{ block.super }}
    {% endwith %}
{% endblock %}

{% block body %}

    {% with record=object %}

        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'portal:dashboard' %}">首页</a></li>
                <li class="breadcrumb-item"><a href="{% url 'portal:record-list' %}">唱片</a></li>
                <li class="breadcrumb-item active" aria-current="page">{{ record.title }}</li>
            </ol>
        </nav>

        <div class="row no-gutters bg-light position-relative">
            <div class="cols-sm-1 col-md-3 col-lg-3 col-xl-3 mb-md-0 p-md-4">
                {#                {% if record.recordcover_exists and record.recordcover.image_exists %}#}
                {#                {% generateimage 'myapp:thumbnail' source=source_file -- alt=record.title id=record.id %}#}
                {#                 {% else %}#}
                {#                {% endif %}#}
                <img src="{{ record.recordcover.image.url }}" class="w-100" alt="{{ record.title }}">
            </div>
            <div class="col-md-6 position-static p-4 pl-md-0">
                <h5 class="mt-0">{{ record.title }}</h5>
                <p>Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras
                    purus odio, vestibulum in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi
                    vulputate fringilla. Donec lacinia congue felis in faucibus.</p>
                <p>
                <p>
                    介质：{{ record.format_value }}
                    <br>
                    编号: {{ record.number }}
                    <br>
                    年代: {{ record.year }}
                    <br>
                    发行时间: {{ record.release_detail|default_if_none:'' }}
                    <br>
                    {% if record.company %}
                        唱片公司: {{ record.company.name }}
                    {% endif %}
                </p>
                <span>歌手:</span>
                {% for artist in record.artists.all %}
                    <a href="{% url 'portal:artist-detail' artist.id %}">{{ artist.name }}</a>
                {% endfor %}
                </p>
                <a href="#" class="stretched-link">Go somewhere</a>
            </div>
        </div>

        <div class="mdl-card__supporting-text no-left-padding">
            <p>
                监制: {{ record.producer|default_if_none:'-' }}
                <br>
                录音: {{ record.recorder|default_if_none:'-' }}
                <br>
                混音: {{ record.mixer|default_if_none:'-' }}
                <br>
                乐手: {{ record.bandsman|default_if_none:'-' }}
                <br>
                说明: {{ record.description|default_if_none:'-' }}
            </p>
        </div>

        <table class="table">
            <thead class="thead-light">
            <tr>
                <th scope="col">#</th>
                <th scope="col">标题</th>
                <th scope="col">歌手</th>
                <th scope="col"></th>
            </tr>
            </thead>
            <tbody>
            {% for song in record.song_set.all %}
                <tr>
                    <th scope="row">{{ forloop.counter }}</th>
                    <td>
                        <a href="{% url 'portal:song-detail' song.id %}">{{ song.title }}</a>
                    </td>
                    <td>
                        <ol>
                            {% for artist in song.artists.all %}
                                <li>
                                    <a href="{% url 'portal:artist-detail-record-list' artist.id %}">{{ artist.name }}</a>
                                </li>
                            {% endfor %}
                        </ol>
                    </td>
                    <td><a href="">详情</a></td>
                </tr>
            {% empty %}
                empty
            {% endfor %}
            </tbody>
        </table>

        {% if record.recordimages_set.all %}
            <div class="mdl-cell mdl-cell--12-col mdl-cell--8-col-tablet mdl-card mdl-shadow--4dp">
                <div class="android-screen-section mdl-typography--text-center">
                    <a name="screens"></a>
                    <div class="android-screens" style="text-align: left;">
                        {% for recordimage in record.recordimages_set.all %}
                            <div class="android-auto android-screen">
                                <div class="lx-square-container">
                                    <div class="lx-square-text">
                                        {% if recordimage.image_exists %}
                                            {% generateimage 'myapp:thumbnail' source=recordimage.image -- alt=record.title id=record.id %}
                                        {% else %}
                                            <div class="lx-center">
                                                <i class="material-icons lx-center-content"
                                                   style="color: gray; font-size: 160px;">album</i>
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        {% endif %}

    {% endwith %}

{% endblock %}